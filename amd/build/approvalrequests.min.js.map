{"version":3,"file":"approvalrequests.min.js","sources":["../src/approvalrequests.js"],"sourcesContent":["define(['jquery', 'core/ajax' ,'core/notification'], function($, Ajax, notification) {\n    return {\n        init: function() {\n            $(document).on('click','.approve, .reject',function(){\n                const REQUEST_ACCEPTED = 1;\n                const REQUEST_REJECTED = 3;\n                let userid = $(this).attr('id').split(':')[1];\n                let courseid = $(this).data('courseid');\n                let requestStatus = $(this).hasClass('approve')?'approve':'reject';\n                let userdisplayname = $(this).data('username');\n                let notificationObject = {\n                    message: `User ${userdisplayname} request has been ${requestStatus == 'approve'?'approved':'rejected'}.`,\n                    type: 'info'\n                    };\n                Ajax.call([\n                    {\n                        methodname: 'enrol_approvalenrol_updaterequests',\n                            args: {\n                                userid: userid,\n                                courseid: courseid,\n                                requeststatus:requestStatus == 'approve' ? REQUEST_ACCEPTED:REQUEST_REJECTED\n                            },\n                            done: function(response) {\n                                if(response.statuscode == 200){\n                                   notification.addNotification(notificationObject);\n                                    let tableBody = '';\n                                    let i=1;\n                                    $.each(response.data, function(index, value){\n                                        let lastrow = (index == response.data.length-1);\n                                        const commonattr={\n                                             'data-courseid': value.courseid,\n                                            'data-username': value.firstname +\" \"+value.lastname,\n                                        };\n                                        let approveicon = $('<img>',{\n                                            src:M.cfg.wwwroot + '/enrol/approvalenrol/pix/check-solid.svg',\n                                            class: 'icon approve',\n                                            id: 'approve-id:'+value.id,\n                                        }).attr(commonattr);\n                                        let rejecticon = $('<img>',{\n                                            src:M.cfg.wwwroot + '/enrol/approvalenrol/pix/xmark-solid.svg',\n                                            class: 'icon reject',\n                                            id: 'reject-id:'+value.id,\n                                        }).attr(commonattr);\n                                         tableBody += `\n                                        <tr class=\"${lastrow?'lastrow':''}\">\n                                            <td class=\"cell c0\">${i}</td>\n                                            <td class=\"cell c1\">${value.firstname + value.lastname}</td>\n                                            <td class=\"cell c2 \">${value.email}</td>\n                                            <td class=\"cell c3 lastcol\">\n                                            ${approveicon.prop('outerHTML')} \n                                            ${rejecticon.prop('outerHTML')}</td>\n                                        </tr>\n                                    `;\n                                    i++;\n                                    });\n                                    $('.generaltable tbody').empty();\n                                    $('.generaltable tbody').append(tableBody);\n\n                                }\n                            },\n                            fail:function(){\n                            }\n                    }\n                ]);\n            });\n        }\n    };\n});"],"names":["define","$","Ajax","notification","init","document","on","userid","this","attr","split","courseid","data","requestStatus","hasClass","userdisplayname","notificationObject","message","type","call","methodname","args","requeststatus","done","response","statuscode","addNotification","tableBody","i","each","index","value","lastrow","length","commonattr","firstname","lastname","approveicon","src","M","cfg","wwwroot","class","id","rejecticon","email","prop","empty","append","fail"],"mappings":"AAAAA,8CAAO,CAAC,SAAU,YAAa,sBAAsB,SAASC,EAAGC,KAAMC,oBAC5D,CACHC,KAAM,WACFH,EAAEI,UAAUC,GAAG,QAAQ,qBAAoB,eAGnCC,OAASN,EAAEO,MAAMC,KAAK,MAAMC,MAAM,KAAK,GACvCC,SAAWV,EAAEO,MAAMI,KAAK,YACxBC,cAAgBZ,EAAEO,MAAMM,SAAS,WAAW,UAAU,SACtDC,gBAAkBd,EAAEO,MAAMI,KAAK,YAC/BI,mBAAqB,CACrBC,uBAAiBF,6CAAqD,WAAjBF,cAA2B,WAAW,gBAC3FK,KAAM,QAEVhB,KAAKiB,KAAK,CACN,CACIC,WAAY,qCACRC,KAAM,CACFd,OAAQA,OACRI,SAAUA,SACVW,cAA+B,WAAjBT,cAhBL,EACA,GAiBbU,KAAM,SAASC,aACe,KAAvBA,SAASC,WAAkB,CAC3BtB,aAAauB,gBAAgBV,wBACxBW,UAAY,GACZC,EAAE,EACN3B,EAAE4B,KAAKL,SAASZ,MAAM,SAASkB,MAAOC,WAC9BC,QAAWF,OAASN,SAASZ,KAAKqB,OAAO,QACvCC,WAAW,iBACKH,MAAMpB,yBACPoB,MAAMI,UAAW,IAAIJ,MAAMK,cAE5CC,YAAcpC,EAAE,QAAQ,CACxBqC,IAAIC,EAAEC,IAAIC,QAAU,2CACpBC,MAAO,eACPC,GAAI,cAAcZ,MAAMY,KACzBlC,KAAKyB,YACJU,WAAa3C,EAAE,QAAQ,CACvBqC,IAAIC,EAAEC,IAAIC,QAAU,2CACpBC,MAAO,cACPC,GAAI,aAAaZ,MAAMY,KACxBlC,KAAKyB,YACPP,0EACYK,QAAQ,UAAU,kFACLJ,oFACAG,MAAMI,UAAYJ,MAAMK,4FACvBL,MAAMc,8IAE3BR,YAAYS,KAAK,uEACjBF,WAAWE,KAAK,2GAG1BlB,OAEA3B,EAAE,uBAAuB8C,QACzB9C,EAAE,uBAAuB+C,OAAOrB,aAIxCsB,KAAK"}